{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "packageRules": [
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TIER 1: DIGEST AUTOMERGE - Safe container rebuilds (no version change)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "description": "Auto-merge container digests for vetted official images",
      "matchDatasources": ["docker"],
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": true,
      "matchUpdateTypes": ["digest"],
      "matchPackageNames": [
        // Core infrastructure
        "ghcr.io/home-assistant/home-assistant",
        "ghcr.io/controlplaneio-fluxcd/flux-operator",
        "ghcr.io/controlplaneio-fluxcd/flux-instance",
        "docker.io/cloudflare/cloudflared",
        "ghcr.io/coredns/coredns",
        "mirror.gcr.io/coredns/coredns"
      ]
    },
    {
      "description": "Auto-merge container digests for trusted maintainers",
      "matchDatasources": ["docker"],
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": true,
      "matchUpdateTypes": ["digest"],
      "matchPackageNames": [
        // VPN/Network
        "ghcr.io/qdm12/gluetun",
        // System utilities
        "ghcr.io/spegel-org/spegel",
        "ghcr.io/stakater/reloader",
        "ghcr.io/k8snetworkplumbingwg/multus-cni",
        "ghcr.io/kashalls/external-dns-unifi-webhook",
        // Media sidecars
        "ghcr.io/onedr0p/exportarr"
      ]
    },
    {
      "description": "Auto-merge GitHub Actions digest updates",
      "matchDatasources": ["github-actions"],
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["digest"],
      "ignoreTests": true
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TIER 2: PATCH AUTOMERGE - Stable apps with release age wait
    // Bug fixes only, community-tested before automerge
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "description": "Auto-merge LinuxServer.io media app patches (3 day wait)",
      "matchDatasources": ["docker"],
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["patch"],
      "minimumReleaseAge": "3 days",
      "matchPackagePatterns": [
        "lscr.io/linuxserver/.*",
        "ghcr.io/linuxserver/.*"
      ]
    },
    {
      "description": "Auto-merge Gluetun patches (5 day wait for VPN caution)",
      "matchDatasources": ["docker"],
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["patch"],
      "minimumReleaseAge": "5 days",
      "matchPackageNames": ["ghcr.io/qdm12/gluetun"]
    },
    {
      "description": "Auto-merge media utility patches (3 day wait)",
      "matchDatasources": ["docker"],
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["patch"],
      "minimumReleaseAge": "3 days",
      "matchPackageNames": [
        "ghcr.io/cleanuparr/cleanuparr",
        "ghcr.io/maintainerr/maintainerr",
        "ghcr.io/wizarrrr/wizarr",
        "golift/notifiarr",
        "docker.io/huntarr/huntarr",
        "sctx/overseerr",
        "ghcr.io/onedr0p/exportarr",
        "ghcr.io/gethomepage/homepage"
      ]
    },
    {
      "description": "Auto-merge patch updates for stable system charts",
      "matchDatasources": ["helm"],
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["patch"],
      "matchPackageNames": [
        "cert-manager",
        "external-secrets",
        "metrics-server",
        "reloader",
        "spegel"
      ]
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TIER 3: REQUIRE MANUAL REVIEW - Critical infrastructure
    // These rules MUST come after automerge rules to override them
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "description": "Require manual review for critical CNI/storage infrastructure",
      "matchDatasources": ["docker", "helm"],
      "automerge": false,
      "matchPackagePatterns": [
        "cilium",
        "rook",
        "ceph",
        "kube-prometheus-stack",
        "envoy-gateway",
        "nvidia"
      ]
    },
    {
      "description": "Require manual review for security components",
      "matchDatasources": ["docker", "helm"],
      "automerge": false,
      "matchPackagePatterns": [
        "authentik",
        "goauthentik"
      ]
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TIER 4: SPECIAL HANDLING - AI apps, Talos
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "description": "Require manual review for AI apps (rapidly evolving)",
      "matchDatasources": ["docker"],
      "automerge": false,
      "matchPackagePatterns": [
        "lightrag",
        "litellm",
        "open-webui",
        "ollama",
        "qdrant"
      ]
    },
    {
      "description": "Auto-merge Talos PETS upgrades (patch versions, 1 day wait)",
      "matchLabels": ["talos-update/pets"],
      "matchUpdateTypes": ["patch"],
      "automerge": true,
      "automergeType": "pr",
      "minimumReleaseAge": "1 day",
      "prBodyNotes": [
        "ğŸ¾ **Talos PETS**: Patch version will be auto-merged after 1-day stabilization. In-place upgrade via talosctl."
      ]
    },
    {
      "description": "Require manual review for Talos CATTLE upgrades (major/minor)",
      "matchLabels": ["talos-update/cattle"],
      "automerge": false,
      "prBodyNotes": [
        "ğŸ„ **Talos CATTLE**: Major/minor version requires manual approval. Full VM rebuild via Terraform."
      ]
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GLOBAL SAFETY NET - Must be LAST rule
    // Ensures minor/major updates always require review
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "description": "Require manual review for major and minor updates",
      "matchUpdateTypes": ["major", "minor"],
      "automerge": false
    }
  ]
}
