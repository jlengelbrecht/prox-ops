---
# ExternalSecret for Homepage - pulls secrets from 1Password
# Combines homepage-specific secrets with existing K8s app API keys
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: homepage-secrets
  namespace: tools
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword-connect
  target:
    name: homepage-secrets
    creationPolicy: Owner
    template:
      engineVersion: v2
      data:
        # ===================
        # API CREDENTIALS
        # ===================
        # Plex
        HOMEPAGE_VAR_PLEX_KEY: "{{ .PLEX_KEY }}"
        # Overseerr
        HOMEPAGE_VAR_OVERSEERR_KEY: "{{ .OVERSEERR_KEY }}"
        # UniFi
        HOMEPAGE_VAR_UNIFI_USERNAME: "{{ .UNIFI_USERNAME }}"
        HOMEPAGE_VAR_UNIFI_PASSWORD: "{{ .UNIFI_PASSWORD }}"
        # Proxmox Valhalla
        HOMEPAGE_VAR_PROXMOX_VALHALLA_USERNAME: "{{ .PROXMOX_VALHALLA_USERNAME }}"
        HOMEPAGE_VAR_PROXMOX_VALHALLA_PASSWORD: "{{ .PROXMOX_VALHALLA_PASSWORD }}"
        # Proxmox Vanir
        HOMEPAGE_VAR_PROXMOX_VANIR_USERNAME: "{{ .PROXMOX_VANIR_USERNAME }}"
        HOMEPAGE_VAR_PROXMOX_VANIR_PASSWORD: "{{ .PROXMOX_VANIR_PASSWORD }}"
        # Proxmox PBS
        HOMEPAGE_VAR_PROXMOX_PBS_USERNAME: "{{ .PROXMOX_PBS_USERNAME }}"
        HOMEPAGE_VAR_PROXMOX_PBS_PASSWORD: "{{ .PROXMOX_PBS_PASSWORD }}"
        # TrueNAS
        HOMEPAGE_VAR_TRUENAS_HEIMDALL_KEY: "{{ .TRUENAS_HEIMDALL_KEY }}"
        HOMEPAGE_VAR_TRUENAS_BALDAR_KEY: "{{ .TRUENAS_BALDAR_KEY }}"
        # Traefik
        HOMEPAGE_VAR_TRAEFIK_USERNAME: "{{ .TRAEFIK_USERNAME }}"
        HOMEPAGE_VAR_TRAEFIK_PASSWORD: "{{ .TRAEFIK_PASSWORD }}"
        # ===================
        # K8S APP API KEYS (from existing 1Password items)
        # ===================
        HOMEPAGE_VAR_SONARR_KEY: "{{ .SONARR_KEY }}"
        HOMEPAGE_VAR_RADARR_KEY: "{{ .RADARR_KEY }}"
        HOMEPAGE_VAR_PROWLARR_KEY: "{{ .PROWLARR_KEY }}"
        HOMEPAGE_VAR_SABNZBD_KEY: "{{ .SABNZBD_KEY }}"
        HOMEPAGE_VAR_TAUTULLI_KEY: "{{ .TAUTULLI_KEY }}"
        HOMEPAGE_VAR_QBITTORRENT_USERNAME: "{{ .QBITTORRENT_USERNAME }}"
        HOMEPAGE_VAR_QBITTORRENT_PASSWORD: "{{ .QBITTORRENT_PASSWORD }}"
        # ===================
        # LINKS - External/Custom Domains
        # ===================
        HOMEPAGE_VAR_UNIFI_MILKYWAY_URL: "{{ .UNIFI_MILKYWAY_URL }}"
        HOMEPAGE_VAR_UNIFI_COSMOS_URL: "{{ .UNIFI_COSMOS_URL }}"
        HOMEPAGE_VAR_UNIFI_IDENTITY_URL: "{{ .UNIFI_IDENTITY_URL }}"
        HOMEPAGE_VAR_UNIFI_MOBILITY_URL: "{{ .UNIFI_MOBILITY_URL }}"
        # ===================
        # LINKS - iDRAC
        # ===================
        HOMEPAGE_VAR_LINK_IDRAC_HEIMDALL: "{{ .LINK_IDRAC_HEIMDALL }}"
        HOMEPAGE_VAR_LINK_IDRAC_ODIN: "{{ .LINK_IDRAC_ODIN }}"
        HOMEPAGE_VAR_LINK_IDRAC_THOR: "{{ .LINK_IDRAC_THOR }}"
        HOMEPAGE_VAR_LINK_IDRAC_BALDAR: "{{ .LINK_IDRAC_BALDAR }}"
        HOMEPAGE_VAR_LINK_IDRAC_BORR: "{{ .LINK_IDRAC_BORR }}"
        HOMEPAGE_VAR_LINK_IDRAC_LOKI: "{{ .LINK_IDRAC_LOKI }}"
        # ===================
        # LINKS - Media Services
        # ===================
        HOMEPAGE_VAR_LINK_PLEX: "{{ .LINK_PLEX }}"
        HOMEPAGE_VAR_LINK_OVERSEERR: "{{ .LINK_OVERSEER }}"
        HOMEPAGE_VAR_LINK_MAINTAINERR: "{{ .LINK_MAINTAINERR }}"
        HOMEPAGE_VAR_LINK_HUNTARR: "{{ .LINK_HUNTARR }}"
        HOMEPAGE_VAR_LINK_CLEANUPARR: "{{ .LINK_CLEANUPARR }}"
        HOMEPAGE_VAR_LINK_PLEX_STATUS: "{{ .LINK_PLEX_STATUS }}"
        HOMEPAGE_VAR_LINK_TAUTULLI: "{{ .LINK_TAUTULLI }}"
        HOMEPAGE_VAR_LINK_WIZARR: "{{ .LINK_WIZARR }}"
        # ===================
        # LINKS - Indexers
        # ===================
        HOMEPAGE_VAR_LINK_SONARR: "{{ .LINK_SONARR }}"
        HOMEPAGE_VAR_LINK_RADARR: "{{ .LINK_RADARR }}"
        HOMEPAGE_VAR_LINK_PROWLARR: "{{ .LINK_PROWLARR }}"
        # ===================
        # LINKS - Downloads
        # ===================
        HOMEPAGE_VAR_LINK_SABNZBD: "{{ .LINK_SABNZBD }}"
        HOMEPAGE_VAR_LINK_QBITTORRENT: "{{ .LINK_QBITTORRENT }}"
        # ===================
        # LINKS - Network
        # ===================
        HOMEPAGE_VAR_LINK_GUESTWIFI_MILKYWAY: "{{ .LINK_GUESTWIFI_MILKYWAY }}"
        HOMEPAGE_VAR_LINK_GUESTWIFI_COSMOS: "{{ .LINK_GUESTWIFI_COSMOS }}"
        HOMEPAGE_VAR_LINK_TRAEFIK: "{{ .LINK_TRAEFIK }}"
        HOMEPAGE_VAR_LINK_CERTWARDEN: "{{ .LINK_CERTWARDEN }}"
        HOMEPAGE_VAR_LINK_AUTHENTIK: "{{ .LINK_AUTHENTIK }}"
        # ===================
        # LINKS - Servers & Storage
        # ===================
        HOMEPAGE_VAR_LINK_PROXMOX_VALHALLA: "{{ .LINK_PROXMOX_VALHALLA }}"
        HOMEPAGE_VAR_LINK_PROXMOX_VANIR: "{{ .LINK_PROXMOX_VANIR }}"
        HOMEPAGE_VAR_LINK_PROXMOX_PBS: "{{ .LINK_PROXMOX_PBS }}"
        HOMEPAGE_VAR_LINK_TRUENAS_HEIMDALL: "{{ .LINK_TRUENAS_HEIMDALL }}"
        HOMEPAGE_VAR_LINK_TRUENAS_BALDAR: "{{ .LINK_TRUENAS_BALDAR }}"
        HOMEPAGE_VAR_LINK_COOLIFY: "{{ .LINK_COOLIFY }}"
        HOMEPAGE_VAR_LINK_EATON_UPS: "{{ .LINK_EATON_UPS }}"
        HOMEPAGE_VAR_LINK_TRIPPLITE: "{{ .LINK_TRIPPLITE }}"
        # ===================
        # LINKS - NVR
        # ===================
        HOMEPAGE_VAR_LINK_NVR_MILKYWAY: "{{ .LINK_NVR_MILKYWAY }}"
        HOMEPAGE_VAR_LINK_NVR_COSMOS: "{{ .LINK_NVR_COSMOS }}"
        # ===================
        # LINKS - Other Tools
        # ===================
        HOMEPAGE_VAR_LINK_WALLOS: "{{ .LINK_WALLOS }}"
        HOMEPAGE_VAR_LINK_GUIDES: "{{ .LINK_GUIDES }}"
        HOMEPAGE_VAR_LINK_NEXTCLOUD: "{{ .LINK_NEXTCLOUD }}"
        HOMEPAGE_VAR_LINK_BYTESTASH: "{{ .LINK_BYTESTASH }}"
        HOMEPAGE_VAR_LINK_ITTOOLS: "{{ .LINK_ITTOOLS }}"
        HOMEPAGE_VAR_LINK_PLANE: "{{ .LINK_PLANE }}"
        HOMEPAGE_VAR_LINK_HOARDER: "{{ .LINK_HOARDER }}"
        # ===================
        # LINKS - AI
        # ===================
        HOMEPAGE_VAR_LINK_LOCALAI: "{{ .LINK_LOCALAI }}"
        HOMEPAGE_VAR_LINK_LOCALAGI: "{{ .LINK_LOCALAGI }}"
        HOMEPAGE_VAR_LINK_LOCALRECALL: "{{ .LINK_LOCALRECALL }}"
        # ===================
        # LINKS - Monitoring
        # ===================
        HOMEPAGE_VAR_LINK_WAZUH: "{{ .LINK_WAZUH }}"
        HOMEPAGE_VAR_LINK_GRAYLOG: "{{ .LINK_GRAYLOG }}"
  data:
    # ===================
    # From homepage-secrets item
    # ===================
    - secretKey: PLEX_KEY
      remoteRef:
        key: homepage-secrets
        property: PLEX_KEY
    - secretKey: OVERSEERR_KEY
      remoteRef:
        key: homepage-secrets
        property: OVERSEERR_KEY
    - secretKey: UNIFI_USERNAME
      remoteRef:
        key: homepage-secrets
        property: UNIFI_USERNAME
    - secretKey: UNIFI_PASSWORD
      remoteRef:
        key: homepage-secrets
        property: UNIFI_PASSWORD
    - secretKey: PROXMOX_VALHALLA_USERNAME
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_VALHALLA_USERNAME
    - secretKey: PROXMOX_VALHALLA_PASSWORD
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_VALHALLA_PASSWORD
    - secretKey: PROXMOX_VANIR_USERNAME
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_VANIR_USERNAME
    - secretKey: PROXMOX_VANIR_PASSWORD
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_VANIR_PASSWORD
    - secretKey: PROXMOX_PBS_USERNAME
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_PBS_USERNAME
    - secretKey: PROXMOX_PBS_PASSWORD
      remoteRef:
        key: homepage-secrets
        property: PROXMOX_PBS_PASSWORD
    - secretKey: TRUENAS_HEIMDALL_KEY
      remoteRef:
        key: homepage-secrets
        property: TRUENAS_HEIMDALL_KEY
    - secretKey: TRUENAS_BALDAR_KEY
      remoteRef:
        key: homepage-secrets
        property: TRUENAS_BALDAR_KEY
    - secretKey: TRAEFIK_USERNAME
      remoteRef:
        key: homepage-secrets
        property: TRAEFIK_USERNAME
    - secretKey: TRAEFIK_PASSWORD
      remoteRef:
        key: homepage-secrets
        property: TRAEFIK_PASSWORD
    # ===================
    # From existing K8s app 1Password items
    # ===================
    - secretKey: SONARR_KEY
      remoteRef:
        key: sonarr-api
        property: api-key
    - secretKey: RADARR_KEY
      remoteRef:
        key: radarr-api
        property: api-key
    - secretKey: PROWLARR_KEY
      remoteRef:
        key: prowlarr-api
        property: api-key
    - secretKey: SABNZBD_KEY
      remoteRef:
        key: sabnzbd-api
        property: api-key
    - secretKey: TAUTULLI_KEY
      remoteRef:
        key: tautulli_api
        property: api-key
    - secretKey: QBITTORRENT_USERNAME
      remoteRef:
        key: qbittorrent-credentials
        property: username
    - secretKey: QBITTORRENT_PASSWORD
      remoteRef:
        key: qbittorrent-credentials
        property: password
    # ===================
    # Links from homepage-secrets
    # ===================
    - secretKey: UNIFI_MILKYWAY_URL
      remoteRef:
        key: homepage-secrets
        property: UNIFI_MILKYWAY_URL
    - secretKey: UNIFI_COSMOS_URL
      remoteRef:
        key: homepage-secrets
        property: UNIFI_COSMOS_URL
    - secretKey: UNIFI_IDENTITY_URL
      remoteRef:
        key: homepage-secrets
        property: UNIFI_IDENTITY_URL
    - secretKey: UNIFI_MOBILITY_URL
      remoteRef:
        key: homepage-secrets
        property: UNIFI_MOBILITY_URL
    - secretKey: LINK_IDRAC_HEIMDALL
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_HEIMDALL
    - secretKey: LINK_IDRAC_ODIN
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_ODIN
    - secretKey: LINK_IDRAC_THOR
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_THOR
    - secretKey: LINK_IDRAC_BALDAR
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_BALDAR
    - secretKey: LINK_IDRAC_BORR
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_BORR
    - secretKey: LINK_IDRAC_LOKI
      remoteRef:
        key: homepage-secrets
        property: LINK_IDRAC_LOKI
    - secretKey: LINK_PLEX
      remoteRef:
        key: homepage-secrets
        property: LINK_PLEX
    - secretKey: LINK_OVERSEER
      remoteRef:
        key: homepage-secrets
        property: LINK_OVERSEER
    - secretKey: LINK_MAINTAINERR
      remoteRef:
        key: homepage-secrets
        property: LINK_MAINTAINERR
    - secretKey: LINK_HUNTARR
      remoteRef:
        key: homepage-secrets
        property: LINK_HUNTARR
    - secretKey: LINK_CLEANUPARR
      remoteRef:
        key: homepage-secrets
        property: LINK_CLEANUPARR
    - secretKey: LINK_PLEX_STATUS
      remoteRef:
        key: homepage-secrets
        property: LINK_PLEX_STATUS
    - secretKey: LINK_TAUTULLI
      remoteRef:
        key: homepage-secrets
        property: LINK_TAUTULLI
    - secretKey: LINK_WIZARR
      remoteRef:
        key: homepage-secrets
        property: LINK_WIZARR
    - secretKey: LINK_SONARR
      remoteRef:
        key: homepage-secrets
        property: LINK_SONARR
    - secretKey: LINK_RADARR
      remoteRef:
        key: homepage-secrets
        property: LINK_RADARR
    - secretKey: LINK_PROWLARR
      remoteRef:
        key: homepage-secrets
        property: LINK_PROWLARR
    - secretKey: LINK_SABNZBD
      remoteRef:
        key: homepage-secrets
        property: LINK_SABNZBD
    - secretKey: LINK_QBITTORRENT
      remoteRef:
        key: homepage-secrets
        property: LINK_QBITTORRENT
    - secretKey: LINK_GUESTWIFI_MILKYWAY
      remoteRef:
        key: homepage-secrets
        property: LINK_GUESTWIFI_MILKYWAY
    - secretKey: LINK_GUESTWIFI_COSMOS
      remoteRef:
        key: homepage-secrets
        property: LINK_GUESTWIFI_COSMOS
    - secretKey: LINK_TRAEFIK
      remoteRef:
        key: homepage-secrets
        property: LINK_TRAEFIK
    - secretKey: LINK_CERTWARDEN
      remoteRef:
        key: homepage-secrets
        property: LINK_CERTWARDEN
    - secretKey: LINK_AUTHENTIK
      remoteRef:
        key: homepage-secrets
        property: LINK_AUTHENTIK
    - secretKey: LINK_PROXMOX_VALHALLA
      remoteRef:
        key: homepage-secrets
        property: LINK_PROXMOX_VALHALLA
    - secretKey: LINK_PROXMOX_VANIR
      remoteRef:
        key: homepage-secrets
        property: LINK_PROXMOX_VANIR
    - secretKey: LINK_PROXMOX_PBS
      remoteRef:
        key: homepage-secrets
        property: LINK_PROXMOX_PBS
    - secretKey: LINK_TRUENAS_HEIMDALL
      remoteRef:
        key: homepage-secrets
        property: LINK_TRUENAS_HEIMDALL
    - secretKey: LINK_TRUENAS_BALDAR
      remoteRef:
        key: homepage-secrets
        property: LINK_TRUENAS_BALDAR
    - secretKey: LINK_COOLIFY
      remoteRef:
        key: homepage-secrets
        property: LINK_COOLIFY
    - secretKey: LINK_EATON_UPS
      remoteRef:
        key: homepage-secrets
        property: LINK_EATON_UPS
    - secretKey: LINK_TRIPPLITE
      remoteRef:
        key: homepage-secrets
        property: LINK_TRIPPLITE
    - secretKey: LINK_NVR_MILKYWAY
      remoteRef:
        key: homepage-secrets
        property: LINK_NVR_MILKYWAY
    - secretKey: LINK_NVR_COSMOS
      remoteRef:
        key: homepage-secrets
        property: LINK_NVR_COSMOS
    - secretKey: LINK_WALLOS
      remoteRef:
        key: homepage-secrets
        property: LINK_WALLOS
    - secretKey: LINK_GUIDES
      remoteRef:
        key: homepage-secrets
        property: LINK_GUIDES
    - secretKey: LINK_NEXTCLOUD
      remoteRef:
        key: homepage-secrets
        property: LINK_NEXTCLOUD
    - secretKey: LINK_BYTESTASH
      remoteRef:
        key: homepage-secrets
        property: LINK_BYTESTASH
    - secretKey: LINK_ITTOOLS
      remoteRef:
        key: homepage-secrets
        property: LINK_ITTOOLS
    - secretKey: LINK_PLANE
      remoteRef:
        key: homepage-secrets
        property: LINK_PLANE
    - secretKey: LINK_HOARDER
      remoteRef:
        key: homepage-secrets
        property: LINK_HOARDER
    - secretKey: LINK_LOCALAI
      remoteRef:
        key: homepage-secrets
        property: LINK_LOCALAI
    - secretKey: LINK_LOCALAGI
      remoteRef:
        key: homepage-secrets
        property: LINK_LOCALAGI
    - secretKey: LINK_LOCALRECALL
      remoteRef:
        key: homepage-secrets
        property: LINK_LOCALRECALL
    - secretKey: LINK_WAZUH
      remoteRef:
        key: homepage-secrets
        property: LINK_WAZUH
    - secretKey: LINK_GRAYLOG
      remoteRef:
        key: homepage-secrets
        property: LINK_GRAYLOG
