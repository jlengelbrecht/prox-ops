---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: ai

resources:
  - ./namespace.yaml
  # EPIC-022: Local AI Platform (Ollama-centric architecture)
  # Architecture validated: 2025-12-10
  # See: .claude/.ai-docs/epics/EPIC-022-local-ai-platform.md
  #
  # Phase 1: Core Platform
  - ./ollama/storage/ks.yaml  # Storage with prune: false - MUST come before ollama
  - ./ollama/ks.yaml          # STORY-080: Ollama LLM backend
  - ./open-webui/storage/ks.yaml  # Storage with prune: false - MUST come before open-webui
  - ./open-webui/ks.yaml          # STORY-081: Chat UI
  - ./qdrant/storage/ks.yaml      # Storage with prune: false - MUST come before qdrant
  - ./qdrant/ks.yaml              # STORY-074: Vector DB for RAG
  #
  # Phase 2: API Layer
  - ./litellm-postgres/storage/ks.yaml  # PostgreSQL storage with prune: false
  - ./litellm-postgres/ks.yaml          # PostgreSQL for LiteLLM virtual keys
  - ./litellm/storage/ks.yaml  # Storage with prune: false - MUST come before litellm
  - ./litellm/ks.yaml          # STORY-075: OpenAI-compatible API gateway
  #
  # Phase 2: Unified RAG
  - ./lightrag/storage/ks.yaml  # Storage with prune: false - MUST come before lightrag
  - ./lightrag/ks.yaml          # STORY-096: LightRAG unified RAG backend
  #
  # Phase 3: Web Search & Crawling (STORY-085)
  - ./searxng/ks.yaml           # SearXNG meta-search engine
  - ./firecrawl/ks.yaml         # Firecrawl web crawler (depends on SearXNG)
