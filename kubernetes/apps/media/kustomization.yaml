---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: media

components:
  - ../../components/sops

resources:
  - ./namespace.yaml
  - ./plex/storage/ks.yaml  # Storage with prune: false - MUST come before plex
  - ./plex/ks.yaml
  - ./arr-storage/ks.yaml  # Shared NFS storage for arr-stack apps
  - ./prowlarr/ks.yaml     # Indexer manager (VPN sidecar for privacy)
  - ./sonarr/ks.yaml       # TV show management
  - ./radarr/ks.yaml       # Movie management
  - ./overseerr/ks.yaml    # Media request management (external access)
  - ./wizarr/ks.yaml       # User invitation system (external access)
  - ./huntarr/ks.yaml      # Automated media hunting
  - ./maintainerr/ks.yaml  # Library maintenance rules
  - ./cleanuparr/ks.yaml   # Download cleanup
  - ./tautulli/ks.yaml     # Plex monitoring and analytics
  - ./notifiarr/ks.yaml    # TRaSH guide sync and notifications
  - ./uptime-kuma/storage/ks.yaml  # Storage with prune: false - MUST come before uptime-kuma
  - ./uptime-kuma/ks.yaml  # Public status page for media stack
  - ./bookstack/storage/ks.yaml  # Storage with prune: false - MUST come before bookstack
  - ./bookstack/ks.yaml  # Documentation wiki with Authentik OIDC
  - ./tetragon-policies/ks.yaml
